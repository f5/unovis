import { moduleMetadata, componentWrapperDecorator } from '@storybook/angular'
import { Meta, Story, ArgsTable } from '@storybook/addon-docs';
import { CurveType } from '@volterra/vis'
import { VisXYContainerModule, VisAxisModule, VisAreaModule } from 'src/public-api'

import { VisAreaComponent } from 'src/components/area/area.component'

import { xyChartContentWrapper } from '../../utils/xy-content-wrapper'
import { baseConfig, getColor } from './xy-area-chart.config'

<Meta
  title="XY Charts/Area"
  component={VisAreaComponent}
  decorators={[
    moduleMetadata({ imports: [VisAreaModule, VisXYContainerModule, VisAxisModule] }),
    componentWrapperDecorator(xyChartContentWrapper)
  ]}
/>

<style>{``}</style>

# Area
### Basic configuration
The Area component has been designed to work together with `<vis-xy-container>`. The minimal Area configuration looks like:
```angular2html
<vis-xy-container [data]="dataArray">
  <vis-area [x]="xAccessor" [y]="yAccessor"></vis-area>
</vis-xy-container>
```
where `data: DataRecord[] = [{x: 0, y: 1}, ...]`, `xAccessor = (d: DataRecord) => d.x` and `yAccessor = (d: DataRecord) => d.y`.
<Story name="Simple Area">
  {{
    props: {
      ...baseConfig(),
      storyHideAxes: true,
      storyHeight: 150,
    },
  }}
</Story>

### Multiple Areas
Area can accept an array of `y` accessors to display multiple areas at once, with a configurable `baseline`:

```
// Define your accessors in the component file:
y = [d => d.y1, d => d.y2, d => d.y3],
baseline = d => d.baseline,

// In the template, pass them to vis-area as inputs:
<vis-area [x]="xAccessor" [y]="yAccessorArray" [baseline]="baselineAccessor"></vis-area>
```

<Story name="Multiple Areas">
  {{
    props: {
      ...baseConfig(),
      y: [d => d.y1, d => d.y2, d => d.y3],
      baseline: d => d.baseline,
      storyHideAxes: true,
    },
  }}
</Story>

### Curve types
Using the `curveType: CurveType` property you can set various curve type options:

##### CurveType.Step
<Story name="Curve Types: Step">
  {{
    props: {
      ...baseConfig(100),
      curveType: CurveType.Step,
      storyHideAxes: true,
      storyHeight: 80,
    },
  }}
</Story>

##### CurveType.Basis
<Story name="Curve Types: Basis">
  {{
    props: {
      ...baseConfig(100),
      curveType: CurveType.Basis,
      storyHideAxes: true,
      storyHeight: 80,
    },
  }}
</Story>

##### CurveType.Linear
<Story name="Curve Types: Linear">
  {{
    props: {
      ...baseConfig(100),
      curveType: CurveType.Linear,
      storyHideAxes: true,
      storyHeight: 80,
    },
  }}
</Story>

### Color
Setting color for a single area is simple, you can achieve that just by setting the `color` property of the component to a hex string.

```
<vis-area ... [color]="#2BAB44"></vis-area>
```

<Story name="Custom Color">
  {{
    props: {
      ...baseConfig(25),
      storyHideAxes: true,
      storyHeight: 100,
      y: d => d.y2,
      curveType: CurveType.Basis,
      baseline: d => d.baseline,
      color: '#2BAB44',
    },
  }}
</Story>

If you want to set color for multiple areas at once, you'll have to define a colors array in your component and reference colors by index in the accessor function:

```javascript
// In the component file, define the colors and the accessor function:
colors = ["#FF4F4E", "#FFBA00", "#2BAB44"]
getColor (data: DataRecord[], i: number) {
  return this.colors[i];
}

// In the template:
<vis-area ... [color]="getColor"></vis-area>
```

<Story name="Custom Color: Multiple Areas">
  {{
    props: {
      ...baseConfig(25),
      storyHideAxes: true,
      storyHeight: 100,
      y: [d => d.y1, d => d.y2, d => d.y3],
      curveType: CurveType.Basis,
      baseline: d => d.baseline,
      color: getColor,
    },
  }}
</Story>

### Additional Styling: CSS Variables
The Area component supports additional styling via CSS variables that you can define for your visualization container. For example:
```css
/* In the styles file */
.visualization-container-div {
    --vis-area-fill-opacity: 0.5    ;
    --vis-area-hover-fill-opacity: 1;
    --vis-area-stroke-width: 1px;
}
```

<Story name="Additional Styling: CSS Variables">
  {{
    props: {
      ...baseConfig(25),
      storyHideAxes: true,
      storyHeight: 100,
      y: d => d.y2,
      color: '#2BAB44',
      curveType: CurveType.Basis,
      baseline: d => d.baseline,
      storyStyles: `
        --vis-area-fill-opacity: 0.5  ;
        --vis-area-hover-fill-opacity: 1;
        --vis-area-stroke-width: 1px;
      `
    },
  }}
</Story>

Here is the list of all supported CSS variables: `--vis-area-cursor`, `--vis-area-fill-opacity`, `--vis-area-stroke-width`, `--vis-area-stroke-dasharray`, `--vis-area-stroke-opacity`, `--vis-area-hover-fill-opacity`, `--vis-area-hover-stroke-width`.


### Events
The Area component supports the following events:
```javascript
// In the component file, define the events configuration:
import { Area } from '@volterra/vis`
...
events = {
  [Area.selectors.area]: {
    click: (data: DataRecord[]) => {},
    mouseover: (data: DataRecord[]) => {},
    mouseleave: (data: DataRecord[]) => {},
    ...
  }
}

// In the template:
<vis-area ... events="events"></vis-area>
```

### Area with Axes
Just like with other XY charts you can easily add axes using `<vis-axis>`:
```angular2html
<vis-xy-container [data]="dataArray">
  <vis-area [x]="xAccessor" [y]="yAccessor"></vis-area>
  <vis-axis type="x" label="X"></vis-axis>
  <vis-axis type="y" label="Y"></vis-axis>
</vis-xy-container>
```
which is going to look like
<Story name="Area with Axes">{{ props: { ...baseConfig() } }}</Story>

### Component Inputs

<ArgsTable of={VisAreaComponent} />
